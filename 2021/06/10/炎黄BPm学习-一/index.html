<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>炎黄BPM学习(一) | 锦瑟流年</title><meta name="keywords" content="炎黄BPM,BPM"><meta name="author" content="流年"><meta name="copyright" content="流年"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="一、环境搭建 手动将%AWS_HOME%&#x2F;db_script目录下对应数据库脚本文件初始化到您已准备好的的AWS数据库里 使用%AWS_HOME%&#x2F;bin&#x2F;passwd.bat 文件，生成AWS数据库密码的加密密码 修改%AWS_HOME%&#x2F;bin&#x2F;conf&#x2F;server.xml 文件中数据库连接信息，其中密码为步骤2生成的加密密 执行%AWS_HOME%&#x2F;bin&#x2F;httpd-startup.sh">
<meta property="og:type" content="article">
<meta property="og:title" content="炎黄BPM学习(一)">
<meta property="og:url" content="http://www.yafeiz.com/2021/06/10/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%B8%80/index.html">
<meta property="og:site_name" content="锦瑟流年">
<meta property="og:description" content="一、环境搭建 手动将%AWS_HOME%&#x2F;db_script目录下对应数据库脚本文件初始化到您已准备好的的AWS数据库里 使用%AWS_HOME%&#x2F;bin&#x2F;passwd.bat 文件，生成AWS数据库密码的加密密码 修改%AWS_HOME%&#x2F;bin&#x2F;conf&#x2F;server.xml 文件中数据库连接信息，其中密码为步骤2生成的加密密 执行%AWS_HOME%&#x2F;bin&#x2F;httpd-startup.sh">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.yafeiz.com/null">
<meta property="article:published_time" content="2021-06-10T09:03:15.000Z">
<meta property="article:modified_time" content="2021-06-11T01:36:33.638Z">
<meta property="article:author" content="流年">
<meta property="article:tag" content="炎黄BPM">
<meta property="article:tag" content="BPM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.yafeiz.com/null"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.yafeiz.com/2021/06/10/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%B8%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-5pNSXdnIWU"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4c15d038e8a16434aa82646f62061b34";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-06-11 09:36:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/index.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">锦瑟流年</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">炎黄BPM学习(一)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-10T09:03:15.000Z" title="发表于 2021-06-10 17:03:15">2021-06-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-11T01:36:33.638Z" title="更新于 2021-06-11 09:36:33">2021-06-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/BPM/">BPM</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="一、环境搭建"><a href="#一、环境搭建" class="headerlink" title="一、环境搭建"></a>一、环境搭建</h3><ol>
<li>手动将<code>%AWS_HOME%/db_script</code>目录下对应数据库脚本文件初始化到您已准备好的的AWS数据库里</li>
<li>使用<code>%AWS_HOME%/bin/passwd.bat</code> 文件，生成AWS数据库密码的加密密码</li>
<li>修改<code>%AWS_HOME%/bin/conf/server.xml </code>文件中数据库连接信息<database/>，其中密码为步骤2生成的加密密</li>
<li>执行<code>%AWS_HOME%/bin/httpd-startup.sh</code>  和  <code>aws_startup.sh (linux)</code>,<code>startup(windows)</code>启动AWS服务</li>
<li>访问地址： <code>http://localhost:8088/portal/console</code>   用户名admin  密码 1</li>
</ol>
<h3 id="二、许可申请"><a href="#二、许可申请" class="headerlink" title="二、许可申请"></a>二、许可申请</h3><h4 id="获取机器码"><a href="#获取机器码" class="headerlink" title="获取机器码"></a>获取机器码</h4><ol>
<li>打开安装目录下的bin文件夹找到licensekey文件。</li>
<li>打开licensekey文件（Windows运行.bat文件；Linux打开.sh文件）。</li>
<li>请输入想要申请授权的<a href="#_%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97IP%E5%9C%B0%E5%9D%80">IP地址</a>，回车。中间部分即为机器码。</li>
<li>把获得的机器码，复制发送给炎黄盈动的人员，重新申请新的软件授权许可文件(license)。</li>
</ol>
<h4 id="获得授权文件"><a href="#获得授权文件" class="headerlink" title="获得授权文件"></a>获得授权文件</h4><p>将得到的license文件，复制到安装目录下的bin文件中，重启服务器就可以了。</p>
<h3 id="三、创建和分发应用"><a href="#三、创建和分发应用" class="headerlink" title="三、创建和分发应用"></a>三、创建和分发应用</h3><p>注意授权即可。其他的详见官方文档。</p>
<h3 id="四、设计部署流程"><a href="#四、设计部署流程" class="headerlink" title="四、设计部署流程"></a>四、设计部署流程</h3><p>简单流程： 创建应用-》创建流程-》测试流程-》部署流程-》访问流程</p>
<p>带表单流程：创建应用-》创建流程-》测试流程-》部署流程-》访问流程-》创建表单（创建BO、创建表单、绑定到流程、测试表单</p>
<p>​    创建表单流程： 创建存储模型-》创建表单模型</p>
<p>​    <em>使用@公式，将表单数据提取到流程和任务标题上</em></p>
<p>​    eg. @form(BO_EU_SUPPORT,NO)-@form(BO_EU_SUPPORT,QTITLE)</p>
<h3 id="五、部署DW数据管理"><a href="#五、部署DW数据管理" class="headerlink" title="五、部署DW数据管理"></a>五、部署DW数据管理</h3><p>数据视图</p>
<h3 id="六、部署方案"><a href="#六、部署方案" class="headerlink" title="六、部署方案"></a>六、部署方案</h3><p><a target="_blank" rel="noopener" href="https://docs.awspaas.com/help/install/#a">本地私有部署</a>、<a target="_blank" rel="noopener" href="https://docs.awspaas.com/help/install/#f">云环境部署</a>、<a target="_blank" rel="noopener" href="https://docs.awspaas.com/help/install/#e">Docker+Kubernetes容器部署</a></p>
<h3 id="七、开发指南"><a href="#七、开发指南" class="headerlink" title="七、开发指南"></a>七、开发指南</h3><h4 id="7-1、开发环境搭建，idea环境搭建。"><a href="#7-1、开发环境搭建，idea环境搭建。" class="headerlink" title="7.1、开发环境搭建，idea环境搭建。"></a>7.1、开发环境搭建，idea环境搭建。</h4><p>  导入导入AWS PaaS平台 bin/patch(如有)、bin/jdbc、bin/lib 目录及其子目录内所有jar包。</p>
<ul>
<li>配置启动类为<code>aws-infrastructure-common.jar</code>的<code>StartUp</code></li>
<li>Working directory 目录为 <code>%AWS_HOME%/bin</code></li>
</ul>
<p>如图所示<img src="C:\Users\Administrator\Desktop\小Q书桌-截图\小Q截图-20210610115055.png" alt="小Q截图-20210610115055"></p>
<p>最后手动执行%AWS_HOME%/bin/httpd-startup.bat(sh)脚本启动AWS WEB服务。</p>
<h4 id="7-2、开发流程事件"><a href="#7-2、开发流程事件" class="headerlink" title="7.2、开发流程事件"></a>7.2、开发流程事件</h4><ul>
<li>继承父类（通常不同类型的事件提供不同的父类），基于<a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/introduction/interface.html">接口编程</a></li>
<li>注册到指定的流程中，等待触发</li>
</ul>
<h5 id="1、开发步骤"><a href="#1、开发步骤" class="headerlink" title="1、开发步骤"></a>1、开发步骤</h5><ul>
<li>继承事件<a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/introduction/interface.html">编程接口</a>，完成代码开发</li>
<li>将jar打包到该App的资源目录（install/%appId%/lib）</li>
<li>选择事件类型之后，自动查找该类型对应的实现类</li>
<li>测试流程执行，在IDE调试代码</li>
<li>注册事件【人工任务】人工任务属性</li>
<li>事件触发器显示java规则<ul>
<li>根据类中继承的抽象类进行匹配</li>
<li>下拉列表的展示内容：类名，描述，版本号，开发商</li>
<li>读取类的成员变量信息，自动生成扩展属性。key值格式：事件名_类名_成员变量名</li>
<li>运行时刻使用填写的值给成员变量赋值</li>
<li>支持已经注册的类的刷新动作，用于成员变量有变化时初始化扩展参数。</li>
</ul>
</li>
</ul>
<p><strong>成员变量</strong></p>
<ul>
<li>事件触发器类提供成员变量的定义，运行时刻，会使用对应的值进行初始化，目前支持类型：String、Date、Integer、Long、Double、Boolean</li>
</ul>
<p><strong>编程接口</strong> </p>
<table>
<thead>
<tr>
<th align="left">接口</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">InterruptListenerInterface</td>
<td align="left">-返回Boolean，中断操作 - 开发者继承<strong>InterruptListener</strong>抽象类</td>
</tr>
<tr>
<td align="left">ValueListenerInterface</td>
<td align="left">-返回String，取值操作 -开发者继承<strong>ValueListener</strong>抽象类</td>
</tr>
<tr>
<td align="left">ExecuteListenerInterface</td>
<td align="left">-逻辑处理 -开发者继承<strong>ExecuteListener</strong>抽象类</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_COMPLETED</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程完成前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2、事件清单"><a href="#2、事件清单" class="headerlink" title="2、事件清单"></a>2、事件清单</h5><h6 id="Process-Event"><a href="#Process-Event" class="headerlink" title="Process Event"></a>Process Event</h6><p><strong>流程通用事件</strong></p>
<p>无论是人工流程还是系统短流程，都被触发的事件</p>
<table>
<thead>
<tr>
<th align="left">事件名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="#PROCESS_BEFORE_CREATE">PROCESS_BEFORE_CREATE</a></td>
<td align="left">流程创建前</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_AFTER_CREATE">PROCESS_AFTER_CREATE</a></td>
<td align="left">流程创建后</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_START">PROCESS_START</a></td>
<td align="left">流程启动</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_SUSPEND">PROCESS_SUSPEND</a></td>
<td align="left">流程挂起</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_RESUME">PROCESS_RESUME</a></td>
<td align="left">流程恢复</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_BEFORE_COMPLETE">PROCESS_BEFORE_COMPLETE</a></td>
<td align="left">流程完成前</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_AFTER_COMPLETE">PROCESS_AFTER_COMPLETE</a></td>
<td align="left">流程完成后</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_BEFORE_TERMINATE">PROCESS_BEFORE_TERMINATE</a></td>
<td align="left">流程终止前</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_AFTER_TERMINATE">PROCESS_AFTER_TERMINATE</a></td>
<td align="left">流程终止后</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_BEFORE_CANCEL">PROCESS_BEFORE_CANCEL</a></td>
<td align="left">流程取消前</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_AFTER_CANCEL">PROCESS_AFTER_CANCEL</a></td>
<td align="left">流程取消后</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_BEFORE_DELETE">PROCESS_BEFORE_DELETE</a></td>
<td align="left">流程删除前</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_AFTER_DELETE">PROCESS_AFTER_DELETE</a></td>
<td align="left">流程删除后</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_BEFORE_REACTIVATE">PROCESS_BEFORE_REACTIVATE</a></td>
<td align="left">流程复活前</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_AFTER_REACTIVATE">PROCESS_AFTER_REACTIVATE</a></td>
<td align="left">流程复活后</td>
</tr>
</tbody></table>
<p><strong>人工流程专有事件</strong></p>
<p>含有人工节点的流程范围内全局事件</p>
<table>
<thead>
<tr>
<th align="left">事件名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="#PROCESS_ACTIVITY_ADHOC_BRANCH">PROCESS_ACTIVITY_ADHOC_BRANCH</a></td>
<td align="left">程序指定后继路线和参与者。如果节点定义了ACTIVITY_ADHOC_BRANCH事件，则优先应用节点的实现</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_FORM_GRID_FILTER">PROCESS_FORM_GRID_FILTER</a></td>
<td align="left">全局表单子表过滤。如果节点定义了FORM_GRID_FILTER事件，则优先应用节点实现</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_FORM_BEFORE_LOAD">PROCESS_FORM_BEFORE_LOAD</a></td>
<td align="left">全局表单加载前事件。如果节点定义了FORM_BEFORE_LOAD事件，则优先应用节点实现</td>
</tr>
<tr>
<td align="left"><a href="#PROCESS_FORM_AFTER_LOAD">PROCESS_FORM_AFTER_LOAD</a></td>
<td align="left">全局表单加载后事件。如果节点定义了FORM_AFTER_LOAD事件，则优先应用节点实现</td>
</tr>
</tbody></table>
<p><strong>子流程专有事件</strong></p>
<p>含有子流程节点的流程范围内全局事件</p>
<table>
<thead>
<tr>
<th align="left">事件名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/callactivity_event/callactivity_before_subprocess_start.html">CALLACTIVITY_BEFORE_SUBPROCESS_START</a></td>
<td align="left">子流程实例创建后启动前事件</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/callactivity_event/callactivity_after_subprocess_complete.html">CALLACTIVITY_AFTER_SUBPROCESS_COMPLETE</a></td>
<td align="left">子流程实例结束后事件</td>
</tr>
</tbody></table>
<h6 id="Activity-Event"><a href="#Activity-Event" class="headerlink" title="Activity Event"></a>Activity Event</h6><p><strong>节点通用事件</strong></p>
<p>流程中各种节点都会触发的事件</p>
<table>
<thead>
<tr>
<th align="left">事件名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/activity_event/task_before_complete.html">TASK_BEFORE_COMPLETE</a></td>
<td align="left">任务完成前</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/activity_event/task_after_complete.html">TASK_AFTER_COMPLETE</a></td>
<td align="left">任务完成后</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/activity_event/task_suspend.html">TASK_SUSPEND</a></td>
<td align="left">任务挂起</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/activity_event/task_resume.html">TASK_RESUME</a></td>
<td align="left">任务恢复</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/activity_event/activity_before_leave.html">ACTIVITY_BEFORE_LEAVE</a></td>
<td align="left">节点离开前</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/activity_event/activity_after_leave.html">ACTIVITY_AFTER_LEAVE</a></td>
<td align="left">节点离开后</td>
</tr>
</tbody></table>
<p><strong>UserTask节点专有事件</strong></p>
<p>当该节点为“UserTask”类型时，以下事件被触发</p>
<table>
<thead>
<tr>
<th align="left">事件名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/usertask_event/activity_adhoc_branch.html">ACTIVITY_ADHOC_BRANCH</a></td>
<td align="left">程序指定后继路线和参与者</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/usertask_event/activity_confirm_participants.html">ACTIVITY_CONFIRM_PARTICIPANTS</a></td>
<td align="left">节点就绪参与者即将产生任务</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/usertask_event/task_before_undo.html">TASK_BEFORE_UNDO</a></td>
<td align="left">任务收回前被触发</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/usertask_event/task_after_undo.html">TASK_AFTER_UNDO</a></td>
<td align="left">任务收回后被触发</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_complete_validate.html">FORM_COMPLETE_VALIDATE</a></td>
<td align="left">流程表单办理前校验</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_toolbar_build.html">FORM_TOOLBAR_BUILD</a></td>
<td align="left">表单工具栏构建</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_before_load.html">FORM_BEFORE_LOAD</a></td>
<td align="left">表单加载前</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_after_load.html">FORM_AFTER_LOAD</a></td>
<td align="left">表单加载后</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_before_save.html">FORM_BEFORE_SAVE</a></td>
<td align="left">表单保存前</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_after_save.html">FORM_AFTER_SAVE</a></td>
<td align="left">表单保存后</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_before_remove.html">FORM_BEFORE_REMOVE</a></td>
<td align="left">表单删除前</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_after_remove.html">FORM_AFTER_REMOVE</a></td>
<td align="left">表单删除后</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_grid_filter.html">FORM_GRID_FILTER</a></td>
<td align="left">表单子表过滤</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_grid_excel_transform.html">FORM_GRID_EXCEL_TRANSFORM</a></td>
<td align="left">表单子表Excel转换处理</td>
</tr>
</tbody></table>
<h6 id="全局事件"><a href="#全局事件" class="headerlink" title="全局事件"></a>全局事件</h6><p>以下事件被引擎全局捕获</p>
<table>
<thead>
<tr>
<th align="left">事件名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">TASK_CREATE</td>
<td align="left">任务创建后</td>
</tr>
<tr>
<td align="left">TASK_READ</td>
<td align="left">任务阅读后</td>
</tr>
<tr>
<td align="left">TASK_COMPLETE</td>
<td align="left">任务执行完</td>
</tr>
<tr>
<td align="left">TASK_DELETE</td>
<td align="left">任务删除后</td>
</tr>
<tr>
<td align="left">TASK_SUSPEND</td>
<td align="left">任务挂起后</td>
</tr>
<tr>
<td align="left">TASK_RESUME</td>
<td align="left">任务恢复后</td>
</tr>
</tbody></table>
<h5 id="3、上下文对象-ProcessExecutionContext"><a href="#3、上下文对象-ProcessExecutionContext" class="headerlink" title="3、上下文对象-ProcessExecutionContext"></a>3、上下文对象-ProcessExecutionContext</h5><h6 id="ctx常用方法"><a href="#ctx常用方法" class="headerlink" title="ctx常用方法"></a>ctx常用方法</h6><ul>
<li>getProcessInstance 获得当前流程实例对象</li>
<li>getTaskInstance 获得当前任务实例对象</li>
<li>getUserContext 获得当前用户上下文对象</li>
<li>getVariable 读取指定的流程变量</li>
<li>isChoiceActionMenu 当前人工任务是否选中了指定的审核菜单</li>
<li>execAtScript 执行@公式脚本</li>
<li>addFormReadOnlyPolicy 程序指定BO操作只读（优先级最高）</li>
<li>addFormEditablePolicy 程序指定BO可编辑（优先级最高）</li>
<li>addFormHiddenPolicy 程序指定BO字段隐藏（优先级最高）</li>
<li>addFormDisplayPolicy 程序指定BO字段显示（优先级最高）</li>
<li>addGridHiddenPolicy 程序指定子表列的BO字段隐藏（优先级最高）</li>
<li>addGridDisplayPolicy 程序指定子表列的BO字段显示（优先级最高）</li>
<li>addFormNotNullPolicy 程序指定BO字段必填（优先级最高）</li>
<li>addFormNullablePolicy 程序指定BO字段选填（优先级最高）</li>
<li>addGridColumnPolicy 程序指定子表列头的字段信息（可控制显示顺序，优先级最高，高于子表列字段的显示隐藏策略）</li>
</ul>
<h5 id="4、常用SDKAPI"><a href="#4、常用SDKAPI" class="headerlink" title="4、常用SDKAPI"></a>4、常用SDKAPI</h5><ul>
<li><p>DBSql 本地数据库操作</p>
</li>
<li><p>SDK.getBOAPI BO表读、写、查操作</p>
</li>
<li><p>SDK.getRuleAPI 执行规则脚本</p>
</li>
<li><p>SDK.getCCAPI 执行CC连接</p>
</li>
<li><p>SDK.getProcessAPI 流程实例控制</p>
</li>
<li><p>SDK.getProcessQueryAPI 流程实例查询</p>
</li>
<li><p>SDK.getTaskAPI 任务实例控制</p>
</li>
<li><p>SDK.getTaskQueryAPI 任务查询</p>
</li>
<li><p>SDK.getHistoryTaskQueryAPI 历史任务查询</p>
</li>
<li><p>SDK.getAppAPI 应用API，如执行ASLP</p>
</li>
<li><p>SDK.getORGAPI 组织结构查询、处理</p>
</li>
<li><p>SDK.getFormAPI 表单接口</p>
<h5 id="5、流程事件"><a href="#5、流程事件" class="headerlink" title="5、流程事件"></a>5、流程事件</h5></li>
</ul>
<h6 id="PROCESS-BEFORE-CREATE"><a href="#PROCESS-BEFORE-CREATE" class="headerlink" title="PROCESS_BEFORE_CREATE"></a><a href="#PROCESS_BEFORE_CREATE">PROCESS_BEFORE_CREATE</a></h6><p><strong>流程创建前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程创建被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，流程创建失败 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>新建流程</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.exception.BPMNError;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_CREATED</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程创建前事件被触发&quot;</span>);</span><br><span class="line">        String str1 = ctx.getParameterOfString(<span class="string">&quot;str1&quot;</span>);<span class="comment">// 从临时变量中获得，在创建前尚未保存流程变量值</span></span><br><span class="line">        <span class="keyword">if</span> (str1 == <span class="keyword">null</span> || str1.equals(<span class="string">&quot;begin&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// 模拟抛出业务异常</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BPMNError(<span class="string">&quot;BIZ001&quot;</span>, <span class="string">&quot;PROCESS_BEFORE_CREATED事件模拟抛出业务异常&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-CREATE"><a href="#PROCESS-AFTER-CREATE" class="headerlink" title="PROCESS_AFTER_CREATE"></a><a href="#PROCESS_AFTER_CREATE">PROCESS_AFTER_CREATE</a></h6><p><strong>流程创建后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>新建流程</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_CREATED</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程创建后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-START"><a href="#PROCESS-START" class="headerlink" title="PROCESS_START"></a><a href="#PROCESS_START">PROCESS_START</a></h6><p><strong>流程启动后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>启动流程</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_START</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程启动后事件被触发--&gt;&quot;</span> + ctx.getProcessExecutionTracks());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-SUSPEND"><a href="#PROCESS-SUSPEND" class="headerlink" title="PROCESS_SUSPEND"></a><a href="#PROCESS_SUSPEND">PROCESS_SUSPEND</a></h6><p><strong>流程挂起后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程挂起</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"><span class="comment">//挂起流程实例</span></span><br><span class="line">SDK.getProcessAPI().suspend(processInst);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_SUSPEND</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程挂起后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-RESUME"><a href="#PROCESS-RESUME" class="headerlink" title="PROCESS_RESUME"></a><a href="#PROCESS_RESUME">PROCESS_RESUME</a></h6><p><strong>流程恢复后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程恢复</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"><span class="comment">//恢复流程实例</span></span><br><span class="line">SDK.getProcessAPI().resume(processInst);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_RESUME</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程恢复后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-BEFORE-COMPLETE"><a href="#PROCESS-BEFORE-COMPLETE" class="headerlink" title="PROCESS_BEFORE_COMPLETE"></a><a href="#PROCESS_BEFORE_COMPLETE">PROCESS_BEFORE_COMPLETE</a></h6><p><strong>流程完成（结束）前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程结束被阻止，该分支被孤立中断</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>流程结束</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//自然结束流程实例时（最后一个任务）</span></span><br><span class="line">SDK.getTaskAPI().completeTask(tasks.get(<span class="number">0</span>), UserContext.fromUID(startUser), <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者终止一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().terminate(processInst,UserContext.fromUID(terminateUser));</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_COMPLETED</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程完成前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-COMPLETE"><a href="#PROCESS-AFTER-COMPLETE" class="headerlink" title="PROCESS_AFTER_COMPLETE"></a><a href="#PROCESS_AFTER_COMPLETE">PROCESS_AFTER_COMPLETE</a></h6><p><strong>流程完成（结束）后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>流程结束</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//自然结束流程实例时（最后一个任务）</span></span><br><span class="line">SDK.getTaskAPI().completeTask(tasks.get(<span class="number">0</span>), UserContext.fromUID(startUser), <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者终止一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().terminate(processInst,UserContext.fromUID(terminateUser))</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_COMPLETED</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程完成后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-BEFORE-TERMINATE"><a href="#PROCESS-BEFORE-TERMINATE" class="headerlink" title="PROCESS_BEFORE_TERMINATE"></a><a href="#PROCESS_BEFORE_TERMINATE">PROCESS_BEFORE_TERMINATE</a></h6><p><strong>流程终止前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程终止被阻止，该分支被孤立中断</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>流程终止</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//终止一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().terminate(processInst,UserContext.fromUID(terminateUser));</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_TERMINATED</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程终止前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-TERMINATE"><a href="#PROCESS-AFTER-TERMINATE" class="headerlink" title="PROCESS_AFTER_TERMINATE"></a><a href="#PROCESS_AFTER_TERMINATE">PROCESS_AFTER_TERMINATE</a></h6><p><strong>流程终止后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>流程终止</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//终止一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().terminate(processInst,UserContext.fromUID(terminateUser));</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_TERMINATED</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程终止后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-BEFORE-CANCEL"><a href="#PROCESS-BEFORE-CANCEL" class="headerlink" title="PROCESS_BEFORE_CANCEL"></a><a href="#PROCESS_BEFORE_CANCEL">PROCESS_BEFORE_CANCEL</a></h6><p><strong>流程取消前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程取消被阻止，该分支被孤立中断</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>流程取消</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//取消一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().cancel(processInst,UserContext.fromUID(cancelUser))</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.util.UtilString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_CANCEL</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程取消前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        String str1 = (String) ctx.getVariable(<span class="string">&quot;str1&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (UtilString.isEmpty(str1) || !str1.equals(<span class="string">&quot;cancel yes&quot;</span>)) &#123;</span><br><span class="line">            info(<span class="string">&quot;流程取消前事件--&gt;测试str1必须为cancel yes值才可以取消&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            info(<span class="string">&quot;流程取消前事件--&gt;str1=&quot;</span> + str1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-CANCEL"><a href="#PROCESS-AFTER-CANCEL" class="headerlink" title="PROCESS_AFTER_CANCEL"></a><a href="#PROCESS_AFTER_CANCEL">PROCESS_AFTER_CANCEL</a></h6><p><strong>流程取消后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，若该流程为子流程可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>流程取消</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//取消一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().cancel(processInst,UserContext.fromUID(cancelUser));</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_CANCEL</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程取消后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-BEFORE-DELETE"><a href="#PROCESS-BEFORE-DELETE" class="headerlink" title="PROCESS_BEFORE_DELETE"></a><a href="#PROCESS_BEFORE_DELETE">PROCESS_BEFORE_DELETE</a></h6><p><strong>流程删除前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程删除被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程取消</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().delete(processInst,UserContext.fromUID(deleteUser));</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.util.UtilString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_DELETED</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程删除前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        String str1 = (String) ctx.getVariable(<span class="string">&quot;str1&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (UtilString.isEmpty(str1) || !str1.equals(<span class="string">&quot;remove yes&quot;</span>)) &#123;</span><br><span class="line">            info(<span class="string">&quot;流程删除前事件--&gt;测试str1必须为remove yes值才可以删除&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            info(<span class="string">&quot;流程删除前事件--&gt;str1=&quot;</span> + str1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-DELETE"><a href="#PROCESS-AFTER-DELETE" class="headerlink" title="PROCESS_AFTER_DELETE"></a><a href="#PROCESS_AFTER_DELETE">PROCESS_AFTER_DELETE</a></h6><p><strong>流程删除后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程删除</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除一个流程实例时</span></span><br><span class="line">SDK.getProcessAPI().delete(processInst,UserContext.fromUID(deleteUser));</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_DELETED</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程删除后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-BEFORE-REACTIVATE"><a href="#PROCESS-BEFORE-REACTIVATE" class="headerlink" title="PROCESS_BEFORE_REACTIVATE"></a><a href="#PROCESS_BEFORE_REACTIVATE">PROCESS_BEFORE_REACTIVATE</a></h6><p><strong>流程复活前被触发</strong></p>
<p>将已执行完的流程再次激活使用时触发。</p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程复活被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程复活</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复活一个已结束的流程实例时</span></span><br><span class="line">SDK.getProcessAPI().reactivate(processInst,targetActivityId,isClearHistory,optUser,targetUser,<span class="string">&quot;原因是要求重新执行&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.util.UtilString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_REACTIVATE</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程激活前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-REACTIVATE"><a href="#PROCESS-AFTER-REACTIVATE" class="headerlink" title="PROCESS_AFTER_REACTIVATE"></a><a href="#PROCESS_AFTER_REACTIVATE">PROCESS_AFTER_REACTIVATE</a></h6><p><strong>流程复活后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程复活</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复活一个已结束的流程实例时</span></span><br><span class="line">SDK.getProcessAPI().reactivate(processInst,targetActivityId,isClearHistory,optUser,targetUser,<span class="string">&quot;原因是要求重新执行&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_REACTIVATE</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程激活后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-ACTIVITY-ADHOC-BRANCH"><a href="#PROCESS-ACTIVITY-ADHOC-BRANCH" class="headerlink" title="PROCESS_ACTIVITY_ADHOC_BRANCH"></a><a href="#PROCESS_ACTIVITY_ADHOC_BRANCH">PROCESS_ACTIVITY_ADHOC_BRANCH</a></h6><p><strong>该流程全局的ADHOC_BRANCH事件，见ACTIVITY_ADHOC_BRANCH说明</strong></p>
<p>业务场景：**.点击办理按钮校验通过后**</p>
<p><strong>流程办理</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建流程实例</span></span><br><span class="line">ProcessInstance processInst = SDK.getProcessAPI().createProcessInstance(processDefId, processBusinessKey,uid,createUserDeptId,createUserRoleId,title,vars);</span><br><span class="line"><span class="comment">//从默认的开始事件启动流程</span></span><br><span class="line">List&lt;TaskInstance&gt; tasks = SDK.getProcessAPI().start(processInst, <span class="keyword">null</span>).fetchActiveTasks();</span><br><span class="line"></span><br><span class="line"><span class="comment">//完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(tasks.get(<span class="number">0</span>), UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ValueListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_ACTIVITY_ADHOC_BRANCH</span> <span class="keyword">extends</span> <span class="title">ValueListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 规则activityDefId:执行人</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ctx.getProcessElement().getName().equals(<span class="string">&quot;U1&quot;</span>)) &#123;</span><br><span class="line">            info(<span class="string">&quot;流程全局跳转事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;obj_c60c1e1780900001d21d59391c441b54:admin&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-FORM-BEFORE-LOAD"><a href="#PROCESS-FORM-BEFORE-LOAD" class="headerlink" title="PROCESS_FORM_BEFORE_LOAD"></a><a href="#PROCESS_FORM_BEFORE_LOAD">PROCESS_FORM_BEFORE_LOAD</a></h6><p><strong>该流程全局的FORM_BEFORE_LOAD事件</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p>如果该流程某个节点注册了FORM_BEFORE_LOAD事件，则对该节点来说，该PROCESS_FORM_BEFORE_LOAD事件失效。</p>
<p>参见<a target="_blank" rel="noopener" href="https://docs.awspaas.com/reference-guide/aws-paas-process-listener-reference-guide/form_event/form_before_load.html">FORM_BEFORE_LOAD</a>事件</p>
<h6 id="PROCESS-FORM-GRID-FILTER"><a href="#PROCESS-FORM-GRID-FILTER" class="headerlink" title="PROCESS_FORM_GRID_FILTER"></a><a href="#PROCESS_FORM_GRID_FILTER">PROCESS_FORM_GRID_FILTER</a></h6><p><strong>该流程全局的FORM_GRID_FILTER事件</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">FormGridFilterListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ValueListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p>如果该流程某个节点注册了FORM_GRID_FILTER事件，则对该节点来说，该PROCESS_FORM_GRID_FILTER事件失效。</p>
<p><strong>场景1：刷新有子表的表单时</strong></p>
<ul>
<li>过滤子表行记录</li>
<li>禁用子表行链接</li>
<li>禁止子表行删除</li>
<li>设置子表行的样式</li>
<li>重新设置子表字段展示数据</li>
</ul>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> FormGridRowLookAndFeel <span class="title">acceptRowData</span><span class="params">(ProcessExecutionContext context, List&lt;BOItemModel&gt; boItemList, BO boData)</span> </span>&#123;</span><br><span class="line">    String tableName = context.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BONAME);</span><br><span class="line">    <span class="keyword">if</span> (tableName.equals(<span class="string">&quot;BO_ACT_PUTONGSUB1&quot;</span>)) &#123;</span><br><span class="line">        <span class="comment">//创建一个对象</span></span><br><span class="line">        FormGridRowLookAndFeel diyLookAndFeel = <span class="keyword">new</span> FormGridRowLookAndFeel();</span><br><span class="line">        String s3 = boData.getString(<span class="string">&quot;S3&quot;</span>);</span><br><span class="line">        String s4 = boData.getString(<span class="string">&quot;S4&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (s3 != <span class="keyword">null</span> &amp;&amp; s3.equals(<span class="string">&quot;50&quot;</span>)) &#123;</span><br><span class="line">            diyLookAndFeel.setLink(<span class="keyword">false</span>);<span class="comment">// 设置这行数据不展示链接</span></span><br><span class="line">            diyLookAndFeel.setRemove(<span class="keyword">false</span>);<span class="comment">// 设置这行数据不允许删除</span></span><br><span class="line">            diyLookAndFeel.setCellCSS(<span class="string">&quot;style=&#x27;background-color:yellow;font-color: ffffff;font-weight: bold;height: 125px&#x27;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s3 != <span class="keyword">null</span> &amp;&amp; s3.equals(<span class="string">&quot;55&quot;</span>)) &#123;</span><br><span class="line">            diyLookAndFeel.setDisplay(<span class="keyword">false</span>);<span class="comment">//不显示这条数据</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s4 != <span class="keyword">null</span> &amp;&amp; s4.equals(<span class="string">&quot;60&quot;</span>)) &#123;</span><br><span class="line">            boData.set(<span class="string">&quot;S1&quot;</span>, <span class="string">&quot;&lt;img src=&#x27;../commons/img/add1_16.png&#x27; border=0&gt;&quot;</span> + s4);<span class="comment">// 重新设定一个字段的值</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//特别说明：</span></span><br><span class="line">        <span class="comment">//如果控制字段子表的`编辑`和`明细`链接的文字的显示隐藏</span></span><br><span class="line">        <span class="comment">//可判断字段名是否是`字段子表`UI组件，然后进行赋值</span></span><br><span class="line">        <span class="comment">//赋值规则：`编辑|明细`</span></span><br><span class="line">        <span class="comment">//如果不显示`编辑`，将该部分留空，如果不显示`明细`，将该部分留空</span></span><br><span class="line">        <span class="comment">//如：`|明细`，`编辑|`，`|`</span></span><br><span class="line">        boData.set(<span class="string">&quot;字段子表字段名&quot;</span>, <span class="string">&quot;编辑|明细&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//处理好之后，将该对象返回</span></span><br><span class="line">        <span class="keyword">return</span> diyLookAndFeel;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;<span class="comment">//返回null按照原始数据展示子表</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>场景2：指定子表排序</strong></p>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">orderByStatement</span><span class="params">(ProcessExecutionContext context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;field1 asc,field2 desc&quot;</span>;<span class="comment">//两种字段组合的排序</span></span><br><span class="line">    <span class="comment">//return &quot;field2 desc&quot;;//单个字段排序</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>场景3：自定义子表的表头Html</strong></p>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 构造一个普通子表的表头Html片段，格式：&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;/tr&gt;，支持多级表头，优先级比表单的自定义表头高</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ctx 流程引擎提供给监听器的上下文对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> formItemModel 子表项模型，可通过该模型获取到子表的BO模型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> displayPolicy 应用显示策略后的可见的字段列表，其中key为字段名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getCustomeTableHeaderHtml</span><span class="params">(ProcessExecutionContext ctx, FormItemModel formItemModel, List&lt;String&gt; displayPolicy)</span></span>;</span><br><span class="line">    StringBuilder html = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    BOModel boModel = BOCache.getInstance().getModel(formItemModel.getBoModelId());<span class="comment">//获取BO模型</span></span><br><span class="line">    List&lt;BOItemModel&gt; boItemList = boModel.getBoItems();</span><br><span class="line">    <span class="keyword">if</span> (displayPolicy != <span class="keyword">null</span> &amp;&amp; displayPolicy.size() &gt; <span class="number">0</span>) &#123;<span class="comment">//判断子表可见字段的内容</span></span><br><span class="line">        html.append(<span class="string">&quot;&lt;tr&gt;&quot;</span>);</span><br><span class="line">        <span class="comment">//下面一行是序号列</span></span><br><span class="line">        html.append(<span class="string">&quot;&lt;th align=&#x27;center&#x27; width=&#x27;50&#x27; style=&#x27;max-width:50px;&#x27;&gt;&lt;I18N#序号&gt;&lt;/th&gt;&quot;</span>).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">//下面四行是复选框列，注意，必须要按照以下格式，否则不能选择数据</span></span><br><span class="line">        String callback = <span class="string">&quot;callback=\&quot;&quot;</span> + Html.toCallJS(<span class="string">&quot;AWSCommonGrid.checkCallback&quot;</span>, <span class="keyword">new</span> Object[] &#123; Html.toJSObj(<span class="string">&quot;this&quot;</span>), formItemModel.getId() &#125;) + <span class="string">&quot;\&quot;&quot;</span>;</span><br><span class="line">        html.append(<span class="string">&quot;&lt;th align=&#x27;center&#x27; width=&#x27;50&#x27; style=&#x27;max-width:50px;&#x27;&gt;&lt;input type=&#x27;checkbox&#x27; class=&#x27;awsui-checkbox check-all&#x27; id=&#x27;check-all-&quot;</span>).append(formItemModel.getId()).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">        html.append(<span class="string">&quot; &quot;</span>).append(callback);</span><br><span class="line">        html.append(<span class="string">&quot; group=&#x27;&quot;</span>).append(formItemModel.getId()).append(<span class="string">&quot;&#x27;/&gt;&lt;/th&gt;&quot;</span>).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String fieldName : displayPolicy) &#123;<span class="comment">//遍历子表的可见字段，最终形成一个Html片段</span></span><br><span class="line">            BOItemModel itemModel = BOCache.getInstance().getBOItemModelByBOName(boModel.getName(), fieldName);</span><br><span class="line">            html.append(<span class="string">&quot;&lt;th&gt;&quot;</span>).append(itemModel.getTitle()).append(<span class="string">&quot;&lt;/th&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        html.append(<span class="string">&quot;&lt;/tr&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> html.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>场景4：自定义AJAX子表的表头JSON</strong></p>
<p><strong>示例</strong></p>
<p>重写**public String getEditGridHeaderJSON(ProcessExecutionContext ctx, FormItemModel formItemModel, List displayPolicy)**方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 构造一个AJAX子表的表头JSON，格式：</span></span><br><span class="line"><span class="comment"> [&#x27;表字段&#x27;, &#123;</span></span><br><span class="line"><span class="comment">    title: &quot;表头&quot;,</span></span><br><span class="line"><span class="comment">    width: 250,</span></span><br><span class="line"><span class="comment">    align: &#x27;center&#x27;,</span></span><br><span class="line"><span class="comment">    colModel: [&#123;</span></span><br><span class="line"><span class="comment">        title: &quot;二级栏目1&quot;,</span></span><br><span class="line"><span class="comment">        align: &#x27;center&#x27;,</span></span><br><span class="line"><span class="comment">        colModel: [</span></span><br><span class="line"><span class="comment">            表字段1,</span></span><br><span class="line"><span class="comment">            表字段2,</span></span><br><span class="line"><span class="comment">            表字段3</span></span><br><span class="line"><span class="comment">        ]</span></span><br><span class="line"><span class="comment">    &#125;, &#123;</span></span><br><span class="line"><span class="comment">        title: &quot;二级栏目2&quot;,</span></span><br><span class="line"><span class="comment">        align: &#x27;center&#x27;,</span></span><br><span class="line"><span class="comment">        colModel: [</span></span><br><span class="line"><span class="comment">            表字段1,</span></span><br><span class="line"><span class="comment">            表字段2</span></span><br><span class="line"><span class="comment">        ]</span></span><br><span class="line"><span class="comment">    &#125;]</span></span><br><span class="line"><span class="comment">&#125;]，</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ctx 流程引擎提供给监听器的上下文对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> formItemModel 子表项模型，可通过该模型获取到子表的BO模型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> displayPolicy 应用显示策略后的可见的字段列表，其中key为字段名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getEditGridHeaderJSON</span><span class="params">(ProcessExecutionContext ctx, FormItemModel formItemModel, List&lt;String&gt; displayPolicy)</span></span>;</span><br><span class="line">    StringBuilder headJson = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    BOModel boModel = BOCache.getInstance().getModel(formItemModel.getBoModelId());<span class="comment">//获取BO模型</span></span><br><span class="line">    List&lt;BOItemModel&gt; boItemList = boModel.getBoItems();</span><br><span class="line">    <span class="keyword">if</span> (displayPolicy != <span class="keyword">null</span> &amp;&amp; displayPolicy.size() &gt; <span class="number">0</span>) &#123;<span class="comment">//判断子表可见字段的内容</span></span><br><span class="line">    <span class="comment">/*    String headJson = &quot;[&#x27;ASSESSOBJECT&#x27;,&#x27;WEIGHT&#x27;,</span></span><br><span class="line"><span class="comment">                + &quot;&#123;&#x27;title&#x27;:&#x27;第一季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&#x27;CONSTANT11&#x27;,&#x27;CONSTANT12&#x27;,&#x27;CONSTANT13&#x27;,&#x27;CONSTANT14&#x27;,&#x27;CONSTANT15&#x27;]&#125;,&quot;+</span></span><br><span class="line"><span class="comment">                  &quot;&#123;&#x27;title&#x27;:&#x27;第二季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&#x27;CONSTANT21&#x27;,&#x27;CONSTANT22&#x27;,&#x27;CONSTANT23&#x27;]&#125;,&quot;+</span></span><br><span class="line"><span class="comment">                  &quot;&#123;&#x27;title&#x27;:&#x27;第三季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&#x27;CONSTANT31&#x27;,&#x27;CONSTANT32&#x27;,&#x27;CONSTANT33&#x27;]&#125;,&quot;+</span></span><br><span class="line"><span class="comment">                  &quot;&#123;&#x27;title&#x27;:&#x27;第四季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&#x27;CONSTANT41&#x27;,&#x27;CONSTANT42&#x27;,&#x27;CONSTANT43&#x27;]&#125;+</span></span><br><span class="line"><span class="comment">                   ]&quot;;*/</span></span><br><span class="line">        headJson.append(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">        String season1 = <span class="string">&quot;&#123;&#x27;title&#x27;:&#x27;第一季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&quot;</span>;<span class="comment">//表头 title 必填 ，align ，width 选填</span></span><br><span class="line">        String season2 = <span class="string">&quot;&#123;&#x27;title&#x27;:&#x27;第二季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&quot;</span>;<span class="comment">//colModel是字段直接写字段名称</span></span><br><span class="line">        String season3 = <span class="string">&quot;&#123;&#x27;title&#x27;:&#x27;第三季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&quot;</span>;</span><br><span class="line">        String season4 = <span class="string">&quot;&#123;&#x27;title&#x27;:&#x27;第四季度&#x27;,&#x27;align&#x27;:&#x27;center&#x27;,&#x27;colModel&#x27;:[&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (String fieldName : displayPolicy) &#123;<span class="comment">//遍历子表的可见字段，最终形成一个JSON片段</span></span><br><span class="line">            BOItemModel itemModel = BOCache.getInstance().getBOItemModelByBOName(boModel.getName(), fieldName);</span><br><span class="line">            <span class="keyword">if</span>(itemModel.getName().equals(<span class="string">&quot;ASSESSOBJECT&quot;</span>))&#123;</span><br><span class="line">               headJson.append(<span class="string">&quot;&#x27;&quot;</span>).append(itemModel.getName()).append(<span class="string">&quot;&#x27;,&quot;</span>);<span class="comment">//没有多级表头直接展示字段</span></span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(itemModel.getName().contains(<span class="string">&quot;WEIGHT&quot;</span>))&#123;</span><br><span class="line">                 headJson.append(<span class="string">&quot;&#x27;&quot;</span>).append(itemModel.getName()).append(<span class="string">&quot;&#x27;,&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(itemModel.getName().contains(<span class="string">&quot;CONSTANT1&quot;</span>))&#123;</span><br><span class="line">                season1+=<span class="string">&quot;&#x27;&quot;</span>+itemModel.getName()+<span class="string">&quot;&#x27;&quot;</span>+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(itemModel.getName().contains(<span class="string">&quot;CONSTANT2&quot;</span>))&#123;</span><br><span class="line">                season2+=<span class="string">&quot;&#x27;&quot;</span>+itemModel.getName()+<span class="string">&quot;&#x27;&quot;</span>+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(itemModel.getName().contains(<span class="string">&quot;CONSTANT3&quot;</span>))&#123;</span><br><span class="line">                season3+=<span class="string">&quot;&#x27;&quot;</span>+itemModel.getName()+<span class="string">&quot;&#x27;&quot;</span>+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(itemModel.getName().contains(<span class="string">&quot;CONSTANT4&quot;</span>))&#123;</span><br><span class="line">                season4+=<span class="string">&quot;&#x27;&quot;</span>+itemModel.getName()+<span class="string">&quot;&#x27;&quot;</span>+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        season1 = season1.substring(<span class="number">0</span>,season1.length()-<span class="number">1</span>)+<span class="string">&quot;]&#125;,&quot;</span>;</span><br><span class="line">        season2 = season2.substring(<span class="number">0</span>,season2.length()-<span class="number">1</span>)+<span class="string">&quot;]&#125;,&quot;</span>;</span><br><span class="line">        season3 = season3.substring(<span class="number">0</span>,season3.length()-<span class="number">1</span>)+<span class="string">&quot;]&#125;,&quot;</span>;</span><br><span class="line">        season4 = season4.substring(<span class="number">0</span>,season4.length()-<span class="number">1</span>)+<span class="string">&quot;]&#125;&quot;</span>;</span><br><span class="line">        headJson.append(season1).append(season2).append(season3).append(season4).append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> headJson.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-BEFORE-RESTART"><a href="#PROCESS-BEFORE-RESTART" class="headerlink" title="PROCESS_BEFORE_RESTART"></a><a href="#PROCESS_BEFORE_RESTART">PROCESS_BEFORE_RESTART</a></h6><p><strong>流程重置前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程重置被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程重置</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重置流程实例</span></span><br><span class="line"> SDK.getProcessAPI().restart( processInst,  restartReason);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.util.UtilString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_BEFORE_DELETED</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程重置前事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="PROCESS-AFTER-RESTART"><a href="#PROCESS-AFTER-RESTART" class="headerlink" title="PROCESS_AFTER_RESTART"></a><a href="#PROCESS_AFTER_RESTART">PROCESS_AFTER_RESTART</a></h6><p><strong>流程重置后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>流程重置</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重置流程实例</span></span><br><span class="line"> SDK.getProcessAPI().restart( processInst,  restartReason);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_PROCESS_AFTER_CANCEL</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;流程重置后事件被触发--&gt;&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6、节点通用事件"><a href="#6、节点通用事件" class="headerlink" title="6、节点通用事件"></a>6、节点通用事件</h5><h6 id="TASK-BEFORE-COMPLETE"><a href="#TASK-BEFORE-COMPLETE" class="headerlink" title="TASK_BEFORE_COMPLETE"></a><a href="#TASK_BEFORE_COMPLETE">TASK_BEFORE_COMPLETE</a></h6><p><strong>任务完成（结束）前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，任务完成被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>完成任务往下推</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(taskInst, UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_BEFORE_COMPLETE</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> <span class="keyword">implements</span> <span class="title">InterruptListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务结束前可以阻止被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode01&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TASK-AFTER-COMPLETE"><a href="#TASK-AFTER-COMPLETE" class="headerlink" title="TASK_AFTER_COMPLETE"></a><a href="#TASK_AFTER_COMPLETE">TASK_AFTER_COMPLETE</a></h6><p><strong>任务完成（结束）后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>完成任务并向下推进时</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(taskInst, UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_AFTER_COMPLETE</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> <span class="keyword">implements</span> <span class="title">ExecuteListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务结束后可以补偿被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode02&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TASK-SUSPEND"><a href="#TASK-SUSPEND" class="headerlink" title="TASK_SUSPEND"></a><a href="#TASK_SUSPEND">TASK_SUSPEND</a></h6><p><strong>任务挂起后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>挂起任务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//挂起任务</span></span><br><span class="line">SDK.getTaskAPI().suspend(taskInst);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_SUSPEND</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务挂起后事件被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TASK-RESUME"><a href="#TASK-RESUME" class="headerlink" title="TASK_RESUME"></a><a href="#TASK_RESUME">TASK_RESUME</a></h6><p><strong>任务恢复后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>恢复任务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//恢复任务</span></span><br><span class="line">SDK.getTaskAPI().resume(taskInst);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_RESUME</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;测试用例&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务恢复后事件被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="ACTIVITY-BEFORE-LEAVE"><a href="#ACTIVITY-BEFORE-LEAVE" class="headerlink" title="ACTIVITY_BEFORE_LEAVE"></a><a href="#ACTIVITY_BEFORE_LEAVE">ACTIVITY_BEFORE_LEAVE</a></h6><p><strong>节点离开前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，节点离开被阻止，该分支被中断于此</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>完成任务并向下推进</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//该节点所有任务都将结束，完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(taskInst, UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_ACTIVITY_BEFORE_LEAVE</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> <span class="keyword">implements</span> <span class="title">InterruptListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;节点离开前可以阻止被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode03&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="ACTIVITY-AFTER-LEAVE"><a href="#ACTIVITY-AFTER-LEAVE" class="headerlink" title="ACTIVITY_AFTER_LEAVE"></a><a href="#ACTIVITY_AFTER_LEAVE">ACTIVITY_AFTER_LEAVE</a></h6><p><strong>节点离开后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>完成任务并向下推进</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//该节点所有任务都将结束，完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(taskInst, UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_ACTIVITY_AFTER_LEAVE</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> <span class="keyword">implements</span> <span class="title">ExecuteListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;节点结束后可以补偿被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode04&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="7、人工任务专有事件"><a href="#7、人工任务专有事件" class="headerlink" title="7、人工任务专有事件"></a>7、人工任务专有事件</h5><h6 id="ACTIVITY-ADHOC-BRANCH"><a href="#ACTIVITY-ADHOC-BRANCH" class="headerlink" title="ACTIVITY_ADHOC_BRANCH"></a><a href="#ACTIVITY_ADHOC_BRANCH">ACTIVITY_ADHOC_BRANCH</a></h6><p><strong>程序指定后继路线和参与者，上一节点准备离开时触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ValueListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ValueListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">-一个格式化的字符串值，如果返回null不干涉 - 格式：节点定义Id:参与者账户 -如果指定节点定义Id，后继路线跳转到该节点 -如果指定参与者账户（多个空格隔开），后继节点的参与者以该值为准</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>完成任务并向下推进</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(tasks.get(<span class="number">0</span>), UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ValueListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ValueListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_ACTIVITY_ADHOC_BRANCH</span> <span class="keyword">extends</span> <span class="title">ValueListener</span> <span class="keyword">implements</span> <span class="title">ValueListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;程序指定后继路线和参与者--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="keyword">if</span> (ctx.getProcessElement().getName().equals(<span class="string">&quot;U1&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;obj_c649377f56b000012274a6807f401783:admin&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="ACTIVITY-CONFIRM-PARTICIPANTS"><a href="#ACTIVITY-CONFIRM-PARTICIPANTS" class="headerlink" title="ACTIVITY_CONFIRM_PARTICIPANTS"></a><a href="#ACTIVITY_CONFIRM_PARTICIPANTS">ACTIVITY_CONFIRM_PARTICIPANTS</a></h6><p><strong>节点就绪参与者即将产生任务</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ValueListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ValueListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">- 一个格式化的字符串值，如果返回null不干涉 - 格式：参与者账户，开发者可以在ProcessExecutionContext上下文中调用 getParameterOfString(“$PARTICIPANTS”)获得引擎通过路由或ACTIVITY_ADHOC_BRANCH事件获取的参与者账户（多个空格隔开） -如果多个账户，将按该节点的多例模式进行处理</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p>业务场景：<strong>获得下个执行任务路径时</strong></p>
<p><strong>完成任务并向下推进时</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//完成任务并向下推进时</span></span><br><span class="line">SDK.getTaskAPI().completeTask(tasks.get(<span class="number">0</span>), UserContext.fromUID(optUser), <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ValueListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ValueListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_ACTIVITY_CONFIRM_PARTICIPANTS</span> <span class="keyword">extends</span> <span class="title">ValueListener</span> <span class="keyword">implements</span> <span class="title">ValueListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;节点就绪参与者即将产生任务被触发&quot;</span>);</span><br><span class="line">        String participants = ctx.getParameterOfString(<span class="string">&quot;$PARTICIPANTS&quot;</span>);</span><br><span class="line">        info(<span class="string">&quot;即将给[&quot;</span> + participants + <span class="string">&quot;]创建人工任务&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;admin admin admin&quot;</span>;<span class="comment">// 不干预当前的委派过程</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TASK-BEFORE-UNDO"><a href="#TASK-BEFORE-UNDO" class="headerlink" title="TASK_BEFORE_UNDO"></a><a href="#TASK_BEFORE_UNDO">TASK_BEFORE_UNDO</a></h6><p><strong>任务收回前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，任务收回被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>收回任务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//收回任务</span></span><br><span class="line">SDK.getTaskAPI().undoTask(taskInstId, uid, undoReason);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_BEFORE_UNDO</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> <span class="keyword">implements</span> <span class="title">InterruptListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务收回前可以阻止被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode01&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TASK-AFTER-UNDO"><a href="#TASK-AFTER-UNDO" class="headerlink" title="TASK_AFTER_UNDO"></a><a href="#TASK_AFTER_UNDO">TASK_AFTER_UNDO</a></h6><p><strong>任务收回后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>收回任务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_AFTER_UNDO</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> <span class="keyword">implements</span> <span class="title">ExecuteListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务收回后可以补偿被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode02&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TASK-AFTER-CREATED"><a href="#TASK-AFTER-CREATED" class="headerlink" title="TASK_AFTER_CREATED"></a><a href="#TASK_AFTER_CREATED">TASK_AFTER_CREATED</a></h6><p><strong>任务创建后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>创建任务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建任务</span></span><br><span class="line">SDK.getTaskAPI().createUserTaskInstance(processInst, parentTaskInstModel, userContext,targetActivityDefId,participant,title);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_TASK_AFTER_CREATED</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> <span class="keyword">implements</span> <span class="title">ExecuteListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        info(<span class="string">&quot;任务创建后可以补偿被触发--&gt;&quot;</span> + ctx.getTaskInstance());</span><br><span class="line">        <span class="comment">// throw new BPMNError(&quot;UCode02&quot;, &quot;User biz error&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8、子流程任务专有事件"><a href="#8、子流程任务专有事件" class="headerlink" title="8、子流程任务专有事件"></a>8、子流程任务专有事件</h5><h6 id="CALLACTIVITY-BEFORE-SUBPROCESS-START"><a href="#CALLACTIVITY-BEFORE-SUBPROCESS-START" class="headerlink" title="CALLACTIVITY_BEFORE_SUBPROCESS_START"></a><a href="#CALLACTIVITY_BEFORE_SUBPROCESS_START">CALLACTIVITY_BEFORE_SUBPROCESS_START</a></h6><p><strong>子流程实例创建后启动前触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
<tr>
<td align="left">参数</td>
<td align="left">CallActivityDefinitionConst.PARAM_CALLACTIVITY_CONTEXT</td>
</tr>
</tbody></table>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.callactivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.constant.CallActivityDefinitionConst;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.TaskBehaviorContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_CALLACTIVITY_BEFORE_SUBPROCESS_START</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 父流程实例对象</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Parent ProcessInstance=&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="comment">// 子流程实例上下文，此阶段子流程实例已创建，未开始流程（无任务实例）</span></span><br><span class="line">        TaskBehaviorContext subProcessCtx = (TaskBehaviorContext) ctx.getParameter(CallActivityDefinitionConst.PARAM_CALLACTIVITY_CONTEXT);</span><br><span class="line">        <span class="comment">// 子流程实例</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Sub ProcessInstance=&quot;</span> + subProcessCtx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="CALLACTIVITY-AFTER-SUBPROCESS-COMPLETE"><a href="#CALLACTIVITY-AFTER-SUBPROCESS-COMPLETE" class="headerlink" title="CALLACTIVITY_AFTER_SUBPROCESS_COMPLETE"></a><a href="#CALLACTIVITY_AFTER_SUBPROCESS_COMPLETE">CALLACTIVITY_AFTER_SUBPROCESS_COMPLETE</a></h6><p><strong>子流程实例结束后触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">抛出异常时，如果该子流程实例是单例或多例的最后一个子流程实例，流程将中断在父流程的<code>子流程任务</code></td>
</tr>
<tr>
<td align="left">参数</td>
<td align="left">CallActivityDefinitionConst.PARAM_CALLACTIVITY_CONTEXT</td>
</tr>
</tbody></table>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.callactivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.constant.CallActivityDefinitionConst;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.TaskBehaviorContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_CALLACTIVITY_AFTER_SUBPROCESS_COMPLETE</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 父流程实例对象</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Parent ProcessInstance=&quot;</span> + ctx.getProcessInstance());</span><br><span class="line">        <span class="comment">// 子流程实例上下文</span></span><br><span class="line">        TaskBehaviorContext subProcessCtx = (TaskBehaviorContext) ctx.getParameter(CallActivityDefinitionConst.PARAM_CALLACTIVITY_CONTEXT);</span><br><span class="line">        <span class="comment">// 子流程实例</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Sub ProcessInstance=&quot;</span> + subProcessCtx.getProcessInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9、流程表单事件"><a href="#9、流程表单事件" class="headerlink" title="9、流程表单事件"></a>9、流程表单事件</h5><h6 id="FORM-COMPLETE-VALIDATE"><a href="#FORM-COMPLETE-VALIDATE" class="headerlink" title="FORM_COMPLETE_VALIDATE"></a><a href="#FORM_COMPLETE_VALIDATE">FORM_COMPLETE_VALIDATE</a></h6><p><strong>流程表单办理前校验,流程办理前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，流程办理被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断 -其中抛出BPMNError异常时，该节点定义的错误边界事件将被捕获， 若未捕获且该流程为子流程，可被父流程CallActivity定义的 边界错误事件捕获。如未定义，业务错误信息包装成结果返回</td>
</tr>
</tbody></table>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.api.local.process.listener.usertask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListenerInterface;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test_FORM_COMPLETE_VALIDATE</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> <span class="keyword">implements</span> <span class="title">InterruptListenerInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//参数获取</span></span><br><span class="line">        <span class="comment">//注意：除特殊说明外，下列参数仅在该事件中场景有效</span></span><br><span class="line">        <span class="comment">//记录ID</span></span><br><span class="line">        String boId = ctx.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BOID);</span><br><span class="line">        <span class="comment">//表单ID</span></span><br><span class="line">        String formId = ctx.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_FORMID);</span><br><span class="line">        <span class="comment">//BO表名</span></span><br><span class="line">        String boName = ctx.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BONAME);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//业务异常代码（自定义）</span></span><br><span class="line">        <span class="comment">//业务异常信息（自定义）</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> BPMNError(<span class="string">&quot;0312&quot;</span>,<span class="string">&quot;订单尚未审核，不能进行支付操作&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="FORM-TOOLBAR-BUILD"><a href="#FORM-TOOLBAR-BUILD" class="headerlink" title="FORM_TOOLBAR_BUILD"></a><a href="#FORM_TOOLBAR_BUILD">FORM_TOOLBAR_BUILD</a></h6><p><strong>表单工具栏构建</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">FormToolbarBuilderListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ValueListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">List<ButtonModel></td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>按钮执行动作</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ValueListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ValueListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">String</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<h6 id="FORM-BEFORE-LOAD"><a href="#FORM-BEFORE-LOAD" class="headerlink" title="FORM_BEFORE_LOAD"></a><a href="#FORM_BEFORE_LOAD">FORM_BEFORE_LOAD</a></h6><p><strong>表单构建前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<h6 id="FORM-AFTER-LOAD"><a href="#FORM-AFTER-LOAD" class="headerlink" title="FORM_AFTER_LOAD"></a><a href="#FORM_AFTER_LOAD">FORM_AFTER_LOAD</a></h6><p><strong>表单构建后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<h6 id="FORM-BEFORE-SAVE"><a href="#FORM-BEFORE-SAVE" class="headerlink" title="FORM_BEFORE_SAVE"></a><a href="#FORM_BEFORE_SAVE">FORM_BEFORE_SAVE</a></h6><p><strong>表单(或子表)保存前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，表单保存被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p>通常，该事件用于在保存前的最后一次校验，可以用来阻止保存</p>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.form.event;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bo.engine.BO;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.sdk.local.SDK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFormBeforeSave</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;表单保存前的事件测试&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProvider</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Actionsoft&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext param)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//参数获取</span></span><br><span class="line">        <span class="comment">//注意：除特殊说明外，下列参数仅在该事件中场景有效</span></span><br><span class="line">        <span class="comment">//记录ID</span></span><br><span class="line">        String boId = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BOID);</span><br><span class="line">        <span class="comment">//表单ID</span></span><br><span class="line">        String formId = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_FORMID);</span><br><span class="line">        <span class="comment">//BO表名</span></span><br><span class="line">        String boName = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BONAME);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 保存前的表单数据，注意：该参数针对不同场景获取内容会有所不同</span></span><br><span class="line">        <span class="comment">// 主表中的保存场景获取主表数据；普通子表页面的保存场景获取的是该条子表的数据；如果需要获得其他数据请使用BOQueryAPI获取</span></span><br><span class="line">        BO formData = (BO) param.getParameter(ListenerConst.FORM_EVENT_PARAM_FORMDATA);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取Ajax子表的数据，由于Ajax子表的数据会同主表保存动作一起触发，需要使用该参数获取</span></span><br><span class="line">        <span class="comment">// 在Ajax子表的工具栏上的“保存”动作和主表的“保存”动作中有效</span></span><br><span class="line">        <span class="comment">// 注意：该数据并不是从数据库中获取，获取的数据取决于表单上对Ajax子表新增的数据与修改的数据的和</span></span><br><span class="line">        List&lt;BO&gt; gridData = (List) param.getParameter(ListenerConst.FORM_EVENT_PARAM_GRIDDATA);</span><br><span class="line">        <span class="comment">//遍历子表的数据</span></span><br><span class="line">        <span class="keyword">for</span> (BO rowData : gridData) &#123;</span><br><span class="line">            <span class="comment">//下面一行示例代码，可以获取Ajax子表的每行记录的新建状态</span></span><br><span class="line">            <span class="keyword">boolean</span> rowDataIsCreate = Boolean.parseBoolean(rowData.getString(<span class="string">&quot;isCreate&quot;</span>));<span class="comment">//注意：isCreate并不是BO的一个字段，该字段是有接口上层赋值的</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 该记录是否新建的状态，由于机制调整，BO对象中的ID是不为空的，不能通过ID判断记录是否处于新建状态还是修改状态</span></span><br><span class="line">        <span class="comment">//注意：该参数仅适用保存前（后）事件中，该参数仅能获取主表的是否新建状态</span></span><br><span class="line">        <span class="keyword">boolean</span> isCreate = param.getParameterOfBoolean(ListenerConst.FORM_EVENT_PARAM_ISCREATE);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//该记录是否通过复制功能创建，用于普通子表的复制时判断该状态</span></span><br><span class="line">        <span class="comment">//注意：该参数仅适用保存前（后）事件中</span></span><br><span class="line">        <span class="keyword">boolean</span> isCopy = param.getParameterOfBoolean(ListenerConst.FORM_EVENT_PARAM_ISCOPY);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;<span class="comment">//返回true可以正常保存表单</span></span><br><span class="line">        <span class="comment">//return false;//可阻止表单保存</span></span><br><span class="line">        <span class="comment">//或者直接抛出BPMNErr异常</span></span><br><span class="line">        <span class="comment">//throw new BPMNError(&quot;0313&quot;,&quot;数据不完整，不能进行保存操作&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="FORM-AFTER-SAVE"><a href="#FORM-AFTER-SAVE" class="headerlink" title="FORM_AFTER_SAVE"></a><a href="#FORM_AFTER_SAVE">FORM_AFTER_SAVE</a></h6><p><strong>表单(或子表)保存后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p>通常，该事件用于补偿处理一些业务逻辑</p>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.form.event;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bo.engine.BO;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.sdk.local.SDK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFormAfterSave</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;表单保存后的事件测试&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProvider</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Actionsoft&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext param)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//参数获取</span></span><br><span class="line">        <span class="comment">//注意：除特殊说明外，下列参数仅在该事件中场景有效</span></span><br><span class="line">        <span class="comment">//记录ID</span></span><br><span class="line">        String boId = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BOID);</span><br><span class="line">        <span class="comment">//表单ID</span></span><br><span class="line">        String formId = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_FORMID);</span><br><span class="line">        <span class="comment">//BO表名</span></span><br><span class="line">        String boName = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BONAME);</span><br><span class="line">        <span class="comment">// 保存前的表单数据，注意：该参数针对不同场景获取内容会有所不同</span></span><br><span class="line">        <span class="comment">// 主表场景获取主表数据；普通子表页面的场景获取的是该条子表的数据；获取其他的数据请使用BOQueryAPI获取</span></span><br><span class="line">        <span class="comment">// 注意：这个数据是在保存前放入的，经过保存之后，这些数据和数据库中的数据是一致的</span></span><br><span class="line">        BO formData = (BO) param.getParameter(ListenerConst.FORM_EVENT_PARAM_FORMDATA);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取Ajax子表在保存时的数据，由于Ajax子表的数据会同主表保存动作一起触发，需要使用该参数获取</span></span><br><span class="line">        <span class="comment">// 在Ajax子表的工具栏上的“保存”动作和主表的“保存”动作中有效</span></span><br><span class="line">        <span class="comment">// 注意：这个数据是在保存前放入的，经过保存之后，这些数据和数据库中的数据是一致的</span></span><br><span class="line">        List&lt;BO&gt; gridData = (List) param.getParameter(ListenerConst.FORM_EVENT_PARAM_GRIDDATA);</span><br><span class="line">        <span class="comment">// 该记录是否新建的状态，由于机制调整，BO对象中的ID是不为空的，不能通过ID判断记录是否处于新建状态还是修改状态</span></span><br><span class="line">        <span class="comment">//注意：该参数仅适用保存前（后）事件中</span></span><br><span class="line">        <span class="keyword">boolean</span> isCreate = param.getParameterOfBoolean(ListenerConst.FORM_EVENT_PARAM_ISCREATE);</span><br><span class="line">        <span class="comment">//该记录是否通过复制功能创建，用于普通子表的复制时判断该状态</span></span><br><span class="line">        <span class="comment">//注意：该参数仅适用保存前（后）事件中</span></span><br><span class="line">        <span class="keyword">boolean</span> isCopy = param.getParameterOfBoolean(ListenerConst.FORM_EVENT_PARAM_ISCOPY);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//注意</span></span><br><span class="line">        <span class="comment">//当该事件处于子表导入后被触发的场景时仅能获取到“ListenerConst.FORM_EVENT_PARAM_BONAME”和“ListenerConst.FORM_EVENT_PARAM_FORMID”</span></span><br><span class="line">        <span class="comment">//参数“ListenerConst.FORM_EVENT_PARAM_ISCREATE”E和“ListenerConst.FORM_EVENT_PARAM_ISCOPY”在该场景不适用</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="FORM-BEFORE-REMOVE"><a href="#FORM-BEFORE-REMOVE" class="headerlink" title="FORM_BEFORE_REMOVE"></a><a href="#FORM_BEFORE_REMOVE">FORM_BEFORE_REMOVE</a></h6><p><strong>表单子表记录删除前被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">InterruptListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">InterruptListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">返回false，子表删除数据动作被阻止</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.form.event;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bo.engine.BO;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.InterruptListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.sdk.local.SDK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFormBeforeRemove</span> <span class="keyword">extends</span> <span class="title">InterruptListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;表单子表记录删除前的事件测试&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProvider</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Actionsoft&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext param)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//参数获取</span></span><br><span class="line">        <span class="comment">//注意：除特殊说明外，下列参数仅在该事件中场景有效</span></span><br><span class="line">        <span class="comment">//子表单项ID</span></span><br><span class="line">        String formItemId = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_FORMID);</span><br><span class="line">        <span class="comment">//BO表名</span></span><br><span class="line">        String boName = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BONAME);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//即将被删除的记录，可用与校验该数据是否存在依赖关系，是否可被删除等</span></span><br><span class="line">        BO bo = (BO) param.getParameter(ListenerConst.FORM_EVENT_PARAM_REMOVED_BO);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//注意：由于使用了事务，操作数据库需要使用如下方式获取的Connection连接</span></span><br><span class="line">        <span class="comment">//该参数仅在表单子表记录删除前（后）有效</span></span><br><span class="line">        Connection conn = (Connection) param.getParameter(ListenerConst.FORM_EVENT_PARAM_CONNECTION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;<span class="comment">//返回true可以删除记录</span></span><br><span class="line">        <span class="comment">//return false;//可阻止记录删除</span></span><br><span class="line">        <span class="comment">//或者直接抛出BPMNErr异常</span></span><br><span class="line">        <span class="comment">//throw new BPMNError(&quot;0314&quot;,&quot;数据被使用，不能进行删除操作&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="FORM-AFTER-REMOVE"><a href="#FORM-AFTER-REMOVE" class="headerlink" title="FORM_AFTER_REMOVE"></a><a href="#FORM_AFTER_REMOVE">FORM_AFTER_REMOVE</a></h6><p><strong>表单子表记录删除后被触发</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExecuteListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ExecuteListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.form.event;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bo.engine.BO;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExecuteListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.sdk.local.SDK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFormAfterRemove</span> <span class="keyword">extends</span> <span class="title">ExecuteListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;表单子表记录删除后的事件测试&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProvider</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Actionsoft&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(ProcessExecutionContext param)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//参数获取</span></span><br><span class="line">        <span class="comment">//注意：除特殊说明外，下列参数仅在该事件中场景有效</span></span><br><span class="line">        <span class="comment">//子表单项ID</span></span><br><span class="line">        String formItemId = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_FORMID);</span><br><span class="line">        <span class="comment">//BO表名</span></span><br><span class="line">        String boName = param.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_BONAME);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//被删除的记录，可读取该信息，进行删除后的补偿操作</span></span><br><span class="line">        BO bo = (BO) param.getParameter(ListenerConst.FORM_EVENT_PARAM_REMOVED_BO);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//注意：由于使用了事务，操作数据库需要使用如下方式获取的Connection连接</span></span><br><span class="line">        <span class="comment">//该参数仅在表单子表记录删除前（后）有效</span></span><br><span class="line">        Connection conn = (Connection) param.getParameter(ListenerConst.FORM_EVENT_PARAM_CONNECTION);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行删除后的业务补偿</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="FORM-GRID-FILTER"><a href="#FORM-GRID-FILTER" class="headerlink" title="FORM_GRID_FILTER"></a><a href="#FORM_GRID_FILTER">FORM_GRID_FILTER</a></h6><p><strong>表单子表过滤(支持普通子表、Ajax子表)</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">FormGridFilterListener</td>
</tr>
<tr>
<td align="left">接口</td>
<td align="left">ValueListenerInterface</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<h6 id="FORM-GRID-EXCEL-TRANSFORM"><a href="#FORM-GRID-EXCEL-TRANSFORM" class="headerlink" title="FORM_GRID_EXCEL_TRANSFORM"></a><a href="#FORM_GRID_EXCEL_TRANSFORM">FORM_GRID_EXCEL_TRANSFORM</a></h6><p><strong>表单子表Excle转换处理</strong></p>
<table>
<thead>
<tr>
<th align="left">项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">抽象类</td>
<td align="left">ExcelTransformListener</td>
</tr>
<tr>
<td align="left">返回值</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left">异常</td>
<td align="left">-如抛出异常时，异常被包装成结果返回，后继执行被中断</td>
</tr>
</tbody></table>
<p><strong>示例</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.actionsoft.apps.poc.form.event;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.core.delegate.ProcessExecutionContext;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ExcelTransformListener;</span><br><span class="line"><span class="keyword">import</span> com.actionsoft.bpms.bpmn.engine.listener.ListenerConst;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFormExcelTransform</span> <span class="keyword">extends</span> <span class="title">ExcelTransformListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;表单中，下载、上传Excel后处理Excel文件的事件测试&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProvider</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Actionsoft&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Workbook <span class="title">fixExcel</span><span class="params">(ProcessExecutionContext ctx, Workbook wb)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//参数获取</span></span><br><span class="line">        <span class="comment">//注意：除特殊说明外，下列参数仅在该事件中场景有效</span></span><br><span class="line">        ctx.getUserContext();<span class="comment">// 用户上下文对象</span></span><br><span class="line">        <span class="comment">// 时间点的常量见上表</span></span><br><span class="line">        String timeState = ctx.getParameterOfString(ListenerConst.FORM_EVENT_PARAM_EXCEL_TIMESTATE);<span class="comment">// 通过该值判断当前事件所处的时间点</span></span><br><span class="line">        <span class="comment">// 判断方式</span></span><br><span class="line">        <span class="keyword">if</span> (ListenerConst.FORM_EXCEL_TIMESTATE_IMPORT_BEFORE.equals(timeState)) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//wb对象可以构造为HSSFWorkbook或者SXSSFWorkbook</span></span><br><span class="line">        <span class="keyword">if</span> (wb <span class="keyword">instanceof</span> HSSFWorkbook) &#123;</span><br><span class="line">            <span class="comment">// 解析Excel（xls格式）</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (wb <span class="keyword">instanceof</span> SXSSFWorkbook) &#123;</span><br><span class="line">            <span class="comment">// 解析Excel（xlsx格式）</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果想要阻止下载或者上传的后续操作，可以return null;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> wb;<span class="comment">//注意，即使对该对象进行修改，上层程序也不会读取新的数据。</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10、输出业务对话"><a href="#10、输出业务对话" class="headerlink" title="10、输出业务对话"></a>10、输出业务对话</h5><h6 id="抛出BPMNError"><a href="#抛出BPMNError" class="headerlink" title="抛出BPMNError"></a>抛出BPMNError</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//业务异常代码（自定义）</span></span><br><span class="line"><span class="comment">//业务异常信息（自定义）</span></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> BPMNError(<span class="string">&quot;ERR0312&quot;</span>,<span class="string">&quot;订单尚未审核，不能进行支付操作&quot;</span>);</span><br></pre></td></tr></table></figure>

<h6 id="使用AlertMessage"><a href="#使用AlertMessage" class="headerlink" title="使用AlertMessage"></a>使用AlertMessage</h6><p><strong>仅适用以下事件</strong></p>
<ul>
<li>FORM_COMPLETE_VALIDATE</li>
<li>FORM_AFTER_SAVE</li>
<li>FORM_BEFORE_LOAD</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以下是表单横幅消息的示例代码，多条消息顺序按照添加的顺序展示</span></span><br><span class="line"><span class="comment">//第一个参数是BO名称，第二个参数是消息内容，这是一个默认的消息</span></span><br><span class="line">ctx.addAlertMessage(boName, <span class="string">&quot;测试横幅警告消息&quot;</span>);</span><br><span class="line">ctx.addAlertMessage(boName, <span class="string">&quot;第二个消息&quot;</span>);</span><br><span class="line">ctx.addAlertMessageInfo(boName, <span class="string">&quot;我是第三个提醒消息&quot;</span>);<span class="comment">//这是一个普通的消息</span></span><br><span class="line">ctx.addAlertMessageWarn(boName, <span class="string">&quot;我是第四个警告消息&quot;</span>);<span class="comment">//这是一个警告的消息</span></span><br><span class="line">ctx.addAlertMessageError(boName, <span class="string">&quot;我是第五个错误消息&quot;</span>);<span class="comment">//这是一个错误的消息</span></span><br><span class="line"><span class="comment">//另外提供了自定义外观的消息，第三个参数指定背景色，第四个参数指定文字颜色</span></span><br><span class="line">ctx.addAlertMessage(boName, <span class="string">&quot;消息&quot;</span>, <span class="string">&quot;bgColor&quot;</span>, <span class="string">&quot;fontColor&quot;</span>);</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">流年</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.yafeiz.com/2021/06/10/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%B8%80/">http://www.yafeiz.com/2021/06/10/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%B8%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.yafeiz.com" target="_blank">锦瑟流年</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%82%8E%E9%BB%84BPM/">炎黄BPM</a><a class="post-meta__tags" href="/tags/BPM/">BPM</a></div><div class="post_share"><div class="social-share" data-image="/null" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/11/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%BA%8C/"><img class="prev-cover" src="/img/index.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">炎黄BPM学习(二)</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/05/Centos7%E5%AE%89%E8%A3%85Docker/"><img class="next-cover" src="/img/index.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Centos7安装Docker</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/06/11/炎黄BPm学习-二/" title="炎黄BPM学习(二)"><img class="cover" src="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-11</div><div class="title">炎黄BPM学习(二)</div></div></a></div><div><a href="/2021/06/17/炎黄BPM学习-三-AT开发/" title="炎黄BPM学习(三)-AT开发"><img class="cover" src="/img/index.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-17</div><div class="title">炎黄BPM学习(三)-AT开发</div></div></a></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">流年</div><div class="author-info__description">锦瑟流年</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn"><i></i><span></span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/1361220256@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">一、环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%AE%B8%E5%8F%AF%E7%94%B3%E8%AF%B7"><span class="toc-number">2.</span> <span class="toc-text">二、许可申请</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%BA%E5%99%A8%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">获取机器码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%BE%97%E6%8E%88%E6%9D%83%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">获得授权文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E5%88%86%E5%8F%91%E5%BA%94%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">三、创建和分发应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%AE%BE%E8%AE%A1%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">四、设计部署流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E9%83%A8%E7%BD%B2DW%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">五、部署DW数据管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88"><span class="toc-number">6.</span> <span class="toc-text">六、部署方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97"><span class="toc-number">7.</span> <span class="toc-text">七、开发指南</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1%E3%80%81%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%8Cidea%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E3%80%82"><span class="toc-number">7.1.</span> <span class="toc-text">7.1、开发环境搭建，idea环境搭建。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2%E3%80%81%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.</span> <span class="toc-text">7.2、开发流程事件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%BC%80%E5%8F%91%E6%AD%A5%E9%AA%A4"><span class="toc-number">7.2.1.</span> <span class="toc-text">1、开发步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E4%BA%8B%E4%BB%B6%E6%B8%85%E5%8D%95"><span class="toc-number">7.2.2.</span> <span class="toc-text">2、事件清单</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Process-Event"><span class="toc-number">7.2.2.1.</span> <span class="toc-text">Process Event</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Activity-Event"><span class="toc-number">7.2.2.2.</span> <span class="toc-text">Activity Event</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.2.3.</span> <span class="toc-text">全局事件</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AF%B9%E8%B1%A1-ProcessExecutionContext"><span class="toc-number">7.2.3.</span> <span class="toc-text">3、上下文对象-ProcessExecutionContext</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ctx%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">7.2.3.1.</span> <span class="toc-text">ctx常用方法</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%B8%B8%E7%94%A8SDKAPI"><span class="toc-number">7.2.4.</span> <span class="toc-text">4、常用SDKAPI</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E6%B5%81%E7%A8%8B%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.5.</span> <span class="toc-text">5、流程事件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-CREATE"><span class="toc-number">7.2.5.1.</span> <span class="toc-text">PROCESS_BEFORE_CREATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-CREATE"><span class="toc-number">7.2.5.2.</span> <span class="toc-text">PROCESS_AFTER_CREATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-START"><span class="toc-number">7.2.5.3.</span> <span class="toc-text">PROCESS_START</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-SUSPEND"><span class="toc-number">7.2.5.4.</span> <span class="toc-text">PROCESS_SUSPEND</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-RESUME"><span class="toc-number">7.2.5.5.</span> <span class="toc-text">PROCESS_RESUME</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-COMPLETE"><span class="toc-number">7.2.5.6.</span> <span class="toc-text">PROCESS_BEFORE_COMPLETE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-COMPLETE"><span class="toc-number">7.2.5.7.</span> <span class="toc-text">PROCESS_AFTER_COMPLETE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-TERMINATE"><span class="toc-number">7.2.5.8.</span> <span class="toc-text">PROCESS_BEFORE_TERMINATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-TERMINATE"><span class="toc-number">7.2.5.9.</span> <span class="toc-text">PROCESS_AFTER_TERMINATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-CANCEL"><span class="toc-number">7.2.5.10.</span> <span class="toc-text">PROCESS_BEFORE_CANCEL</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-CANCEL"><span class="toc-number">7.2.5.11.</span> <span class="toc-text">PROCESS_AFTER_CANCEL</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-DELETE"><span class="toc-number">7.2.5.12.</span> <span class="toc-text">PROCESS_BEFORE_DELETE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-DELETE"><span class="toc-number">7.2.5.13.</span> <span class="toc-text">PROCESS_AFTER_DELETE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-REACTIVATE"><span class="toc-number">7.2.5.14.</span> <span class="toc-text">PROCESS_BEFORE_REACTIVATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-REACTIVATE"><span class="toc-number">7.2.5.15.</span> <span class="toc-text">PROCESS_AFTER_REACTIVATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-ACTIVITY-ADHOC-BRANCH"><span class="toc-number">7.2.5.16.</span> <span class="toc-text">PROCESS_ACTIVITY_ADHOC_BRANCH</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-FORM-BEFORE-LOAD"><span class="toc-number">7.2.5.17.</span> <span class="toc-text">PROCESS_FORM_BEFORE_LOAD</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-FORM-GRID-FILTER"><span class="toc-number">7.2.5.18.</span> <span class="toc-text">PROCESS_FORM_GRID_FILTER</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-BEFORE-RESTART"><span class="toc-number">7.2.5.19.</span> <span class="toc-text">PROCESS_BEFORE_RESTART</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PROCESS-AFTER-RESTART"><span class="toc-number">7.2.5.20.</span> <span class="toc-text">PROCESS_AFTER_RESTART</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E8%8A%82%E7%82%B9%E9%80%9A%E7%94%A8%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.6.</span> <span class="toc-text">6、节点通用事件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-BEFORE-COMPLETE"><span class="toc-number">7.2.6.1.</span> <span class="toc-text">TASK_BEFORE_COMPLETE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-AFTER-COMPLETE"><span class="toc-number">7.2.6.2.</span> <span class="toc-text">TASK_AFTER_COMPLETE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-SUSPEND"><span class="toc-number">7.2.6.3.</span> <span class="toc-text">TASK_SUSPEND</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-RESUME"><span class="toc-number">7.2.6.4.</span> <span class="toc-text">TASK_RESUME</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#ACTIVITY-BEFORE-LEAVE"><span class="toc-number">7.2.6.5.</span> <span class="toc-text">ACTIVITY_BEFORE_LEAVE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#ACTIVITY-AFTER-LEAVE"><span class="toc-number">7.2.6.6.</span> <span class="toc-text">ACTIVITY_AFTER_LEAVE</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81%E4%BA%BA%E5%B7%A5%E4%BB%BB%E5%8A%A1%E4%B8%93%E6%9C%89%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.7.</span> <span class="toc-text">7、人工任务专有事件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ACTIVITY-ADHOC-BRANCH"><span class="toc-number">7.2.7.1.</span> <span class="toc-text">ACTIVITY_ADHOC_BRANCH</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#ACTIVITY-CONFIRM-PARTICIPANTS"><span class="toc-number">7.2.7.2.</span> <span class="toc-text">ACTIVITY_CONFIRM_PARTICIPANTS</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-BEFORE-UNDO"><span class="toc-number">7.2.7.3.</span> <span class="toc-text">TASK_BEFORE_UNDO</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-AFTER-UNDO"><span class="toc-number">7.2.7.4.</span> <span class="toc-text">TASK_AFTER_UNDO</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#TASK-AFTER-CREATED"><span class="toc-number">7.2.7.5.</span> <span class="toc-text">TASK_AFTER_CREATED</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8%E3%80%81%E5%AD%90%E6%B5%81%E7%A8%8B%E4%BB%BB%E5%8A%A1%E4%B8%93%E6%9C%89%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.8.</span> <span class="toc-text">8、子流程任务专有事件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#CALLACTIVITY-BEFORE-SUBPROCESS-START"><span class="toc-number">7.2.8.1.</span> <span class="toc-text">CALLACTIVITY_BEFORE_SUBPROCESS_START</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CALLACTIVITY-AFTER-SUBPROCESS-COMPLETE"><span class="toc-number">7.2.8.2.</span> <span class="toc-text">CALLACTIVITY_AFTER_SUBPROCESS_COMPLETE</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9%E3%80%81%E6%B5%81%E7%A8%8B%E8%A1%A8%E5%8D%95%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.2.9.</span> <span class="toc-text">9、流程表单事件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-COMPLETE-VALIDATE"><span class="toc-number">7.2.9.1.</span> <span class="toc-text">FORM_COMPLETE_VALIDATE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-TOOLBAR-BUILD"><span class="toc-number">7.2.9.2.</span> <span class="toc-text">FORM_TOOLBAR_BUILD</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-BEFORE-LOAD"><span class="toc-number">7.2.9.3.</span> <span class="toc-text">FORM_BEFORE_LOAD</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-AFTER-LOAD"><span class="toc-number">7.2.9.4.</span> <span class="toc-text">FORM_AFTER_LOAD</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-BEFORE-SAVE"><span class="toc-number">7.2.9.5.</span> <span class="toc-text">FORM_BEFORE_SAVE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-AFTER-SAVE"><span class="toc-number">7.2.9.6.</span> <span class="toc-text">FORM_AFTER_SAVE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-BEFORE-REMOVE"><span class="toc-number">7.2.9.7.</span> <span class="toc-text">FORM_BEFORE_REMOVE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-AFTER-REMOVE"><span class="toc-number">7.2.9.8.</span> <span class="toc-text">FORM_AFTER_REMOVE</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-GRID-FILTER"><span class="toc-number">7.2.9.9.</span> <span class="toc-text">FORM_GRID_FILTER</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#FORM-GRID-EXCEL-TRANSFORM"><span class="toc-number">7.2.9.10.</span> <span class="toc-text">FORM_GRID_EXCEL_TRANSFORM</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10%E3%80%81%E8%BE%93%E5%87%BA%E4%B8%9A%E5%8A%A1%E5%AF%B9%E8%AF%9D"><span class="toc-number">7.2.10.</span> <span class="toc-text">10、输出业务对话</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8A%9B%E5%87%BABPMNError"><span class="toc-number">7.2.10.1.</span> <span class="toc-text">抛出BPMNError</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8AlertMessage"><span class="toc-number">7.2.10.2.</span> <span class="toc-text">使用AlertMessage</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/24/%E7%BB%8F%E5%85%B8%E8%AF%AD%E5%BD%95-%E4%BA%8C/" title="经典语录(二)">经典语录(二)</a><time datetime="2021-06-24T07:13:52.000Z" title="发表于 2021-06-24 15:13:52">2021-06-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/17/%E7%82%8E%E9%BB%84BPM%E5%AD%A6%E4%B9%A0-%E4%B8%89-AT%E5%BC%80%E5%8F%91/" title="炎黄BPM学习(三)-AT开发">炎黄BPM学习(三)-AT开发</a><time datetime="2021-06-17T02:55:27.000Z" title="发表于 2021-06-17 10:55:27">2021-06-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/11/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%BA%8C/" title="炎黄BPM学习(二)">炎黄BPM学习(二)</a><time datetime="2021-06-11T01:17:45.000Z" title="发表于 2021-06-11 09:17:45">2021-06-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/10/%E7%82%8E%E9%BB%84BPm%E5%AD%A6%E4%B9%A0-%E4%B8%80/" title="炎黄BPM学习(一)">炎黄BPM学习(一)</a><time datetime="2021-06-10T09:03:15.000Z" title="发表于 2021-06-10 17:03:15">2021-06-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/05/Centos7%E5%AE%89%E8%A3%85Docker/" title="Centos7安装Docker">Centos7安装Docker</a><time datetime="2021-06-05T00:21:33.000Z" title="发表于 2021-06-05 08:21:33">2021-06-05</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/index.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 流年</div><div class="icp"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/#/Integrated/recordQuery"><img class="icp-icon" src="/img/icp.png" alt="ICP"/><span>豫ICP备20002785号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script></div></body></html>